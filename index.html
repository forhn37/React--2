<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div id="root"></div>
</body>
<script>
  
function component (elementNode, attributes, children) {

// HTML Element 문자열로 '조립(assemble)'하는 패턴
let elementStr = `<${elementNode}`;
for(let key in attributes) { // 객체의 키(key)를 배열처럼 순회한다
  //매개변수 attributes는 객체여야 for in 문을 사용할 수 있다. 
  //대표적으로 python에서는 해당 문법 접근이 기본 반복문이다. 
  elementStr += ` ${key}="${attributes[key]}"`;
  console.log(elementStr)
}
elementStr += '>';
// 만약 children이라는 값이 '있다면' true 판정이 이루어진다. 
// 조건식에서 "존재유무"로도 사용하기도 한다. 

if(children) {
  children.forEach((child) => {
    // children 매개변수는 배열이어야 한다. 
    // 배열의 각 요소를 순회하는 forEach()를 사용하였다. 
    // 절차형으로 for문을 사용해도 되지만, 자바스크립트 다운 방식으로
    // 작성했다. 
    if (typeof child === 'string') {
      elementStr += child;
    } else {
      elementStr = component(child.elementNode, child.attributes, child.children);
    }
  })
}
elementStr += `</${elementNode}>`; // 맨 위 변수에 덧붙여서 반환한다.

return elementStr; // 함수가 호출되는 순간 문자열이 반환된다. 
}

window.addEventListener('hashchange', () => {
  const contentDiv = document.getElementById('root');
  // window.location 객체는, 현재 URL에 대한 정보를 제공한다. 
  // hash 속성은 URL의 해시 부분을 반환한다. 
  // 예를 들어, http://example.com#page1 이라는 URL이 있다면, hash 속성은 #page1을 반환한다. 
  // substr() 메서드는 문자열에서 특정 위치에서 시작하여 특정 문자 수 만큼의문자들을 반환한다. 
  // #을 제외한 문자열을 반환하기 위해 substr(1<-[시작인덱스])을 사용한다. 
  // <a> 태그의 href 속성에는 #page1, #page2, #page3, #page4가 있다. 
  const hash = window.location.hash.substr(1);

  // if(hash === 'page1') {}
  // else if (hash === 'page2') {}
  // if() 조건문의 패턴을 뒤로하고, switch문을 사용했다.
  // switch() 문자체가 '일관된 조건식'을 뉘앙스로 설명하기 때문에
  // '모두 읽지 않아도' 어떤 작용을 해낸다는 것을 알게 된다. 

  switch(hash) {
    case 'page1' : 
    contentDiv.innerHTML = component('h1', {style:'color:blue'}, ["This is Page 1"])
    break;
    case 'page2' : 
    contentDiv.innerHTML = component('div', {style:'background-color:codeblue;'},[component('h1',{}, ['This is Page2'])]);
    break;
    case 'page3':
    contentDiv.innerHTML = component('div', {style:'display:flex; justify-content:center; color:#ff2222;'},[component('h1',{}, ['This is Page3'])]);  
    break;
    case 'page4':
    contentDiv.innerHTML = component('div', {style:'display:flex; justify-content:center; color:#333;'},[component('h1',{}, ['This is Page4'])]);  
    break;
    default:// 조건이 모두다 부합하지 않을때, 즉 false일때 default가 실행된다. 최초 접속에는 hash가 없기 때문에 default가 실행된다. 
      contentDiv.innerHTML = component('h1', {}, ['반갑습니다. 접속할 때 보이는 페이지(처럼보이는) element입니다.'])
  }
})

// 초기 로딩을 위한 코드
window.dispatchEvent(new Event('hashchange'));
// 위의 addEventListener()는 window 객체에 이벤트 핸들러이고, 변화가 있을 때마다 이벤트가 발생한다. 
// 그러나, 초기 로딩 시에는 이벤트가 발생하지 않는다. 
// 따라서, 초기 로딩 시에는 이벤트가 발생하도록 하기 위해 dispatchEvent()를 사용한다. 
// dispatchEvent()는 지정된 이벤트를 생성하여, 이벤트를 발생시킨다. 
</script>
</html>